{% extends 'tech/user_view.html' %}
{% block cssExtends %}
    <link rel="stylesheet" href="/css/jquery.avatar.css" type="text/css"/>
{% endblock %}
{% block content %}
    <section class="content-wrapper">
        <section class="content">
            {% if msg %}
                <div class="alert {% if msg.type == 'error' %}alert-danger{% else %}alert-success{% endif %} alert-dismissible"
                     role="alert">
                    <button type="button" class="close" data-dismiss="alert"
                            aria-label="Close">
                        <span aria-hidden="true">&times;</span></button>
                    {{ msg.content }}
                </div>
            {% endif %}
            <form id="edit-form" method="post"> <!-- enctype="multipart/form-data" -->
                <div class="box box-solid box-primary">
                    <div class="box-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Tên đăng nhập:</label>
                                    <input type="text" class="form-control" name="user_login"
                                           value="{{ user.user_login }}" disabled/>
                                </div>

                                <div class="form-group">
                                    <label>Tên hiển thị: </label>
                                    <input type="text" class="form-control" name="display_name"
                                           value="{{ user.display_name }}" required="required"/>
                                </div>


                                <div class="form-group" style="position: relative;">
                                    <label>Mật khẩu</label>
                                    <input type="password" class="form-control" value="46464654"
                                           disabled/>
                                    <a class="btn btn-sm btn-danger" data-toggle="modal"
                                       href="#confirm"
                                       style="position: absolute;top: 27px;right: 2px;">
                                        <i class="fa fa-lock"></i> Đổi mật khẩu
                                    </a>
                                </div>

                                <div class="form-group">
                                    <label>Số điện thoại: </label>
                                    <input type="text" class="form-control" name="phone"
                                           value="{{ user.phone }}" required="required"/>
                                </div>

                                <div class="form-group">
                                    <label>Địa chỉ email:</label>
                                    <input type="email" class="form-control" name="user_email"
                                           value="{{ user.user_email }}" disabled/>
                                </div>

                                <div class="form-group">
                                    <label>Giới thiệu:</label>
                                                        <textarea style="resize:none" cols="40" rows="5"
                                                                  maxlength="1000"
                                                                  class="form-control" name="user_biology"
                                                                  placeholder="">{{ user.users_info.user_biology }}</textarea>
                                </div>

                                <button class="btn btn-sm btn-success">
                                    Cập nhật
                                </button>
                            </div>

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Avatar <span class="help-block"
                                                        style="display: inline;">(128x128px) </span></label>
                                    <a href="#" id="avt" class="btn btn-primary btn-block"><i class="fa fa-upload"></i> Chọn/đăng ảnh đại diện</a>

                                    <img style="margin: 15px 0" class="img img-thumbnail" id="user_image" src="{{ user.user_image_url }}"/>
                                    <input type="hidden" name="user_image_url" value="{{ user.user_image_url }}">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </section>
    </section>

    <!-- End post content -->
    <div class="modal fade" id="confirm" tabindex="-1" role="basic" aria-hidden="true">
        <div class="modal-dialog" style="max-width: 600px">
            <form method="post" action="/user/change-pass">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Thay đổi mật khẩu: </h4>
                    </div>
                    <div class="modal-body">

                        <div class="form-group">
                            <label class="control-label">Mật khẩu cũ:</label>
                            <input type="password" class="form-control" name="old_pass" id="old_pass">
                        </div>
                        <div class="form-group">
                            <label class="control-label">Mật khẩu mới:</label>
                            <input type="password" class="form-control" id="user_pass" name="user_pass">
                        </div>
                        <div class="form-group">
                            <label class="control-label">Nhắc lại mật khẩu</label>
                            <input type="password" class="form-control" id="confirm_pass">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal"> Hủy
                        </button>
                        <button type="submit" class="btn btn-danger">
                            Thay đổi
                        </button>
                    </div>

                </div>
            </form>
            <!-- /.modal-content -->
        </div>

    </div>

{% endblock %}

{% block jsExtends %}
    <script src="/js/jquery.cropit.min.js" type="text/javascript"></script>
    <script src="/js/jquery.avatar_cropit.js" type="text/javascript"></script>
    <script>

        $(document).ready(function(){
            $.callAvatarModal($('#avt'), {
                root: '/avatar-gallery/',
                input_elem: 'input[name=user_image_url]',
                preview_elem: '#user_image',
                form: '#edit-form'
            });
        });

        var password = document.getElementById("user_pass")
                , confirm_password = document.getElementById("confirm_pass");

        function validatePassword() {
            if (password.value != confirm_password.value) {
                confirm_password.setCustomValidity("Password confirmation does not match");
            } else {
                confirm_password.setCustomValidity('');
            }
        }

        password.onchange = validatePassword;
        confirm_password.onkeyup = validatePassword;
    </script>
{% endblock %}